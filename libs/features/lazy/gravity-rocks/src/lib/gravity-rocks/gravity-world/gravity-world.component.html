<div class="sim-layout">
  <mat-card appearance="raised" class="gravitational-force-card-controls">
    <mat-card-header>
      <mat-card-title>Play with the values</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <form [formGroup]="form" class="configuration">
        <p>
          <mat-form-field appearance="outline">
            <mat-label>Gravitational Force</mat-label>
            <input matInput type="number" formControlName="gravitationalConstant" />
            <mat-hint>Gravitational constant</mat-hint>
          </mat-form-field>
        </p>
        <p>
          <mat-form-field appearance="outline">
            <mat-label>Mass of Sun</mat-label>
            <input matInput type="number" formControlName="massOfSun" />
            <mat-hint>More mass more gravity</mat-hint>
          </mat-form-field>
        </p>
      </form>
      <mat-list class="info-list">
        <h4 mat-subheader>Infos</h4>
        <mat-list-item>
          <span>Planets = {{ planets().length }}</span>
        </mat-list-item>
        <mat-list-item>
          <span>Forces = {{ worldService.getForces().length }}</span>
        </mat-list-item>
        <mat-list-item *ngFor="let planet of planets(); let i = index">
          <div class="planet-info-item">
            <span [style.background-color]="planet.color">
              Planet{{ i + 1 }}: x={{ planet.pos.x | number: '1.0-0' }},y={{ planet.pos.y | number: '1.0-0' }}
            </span>
            <button mat-icon-button (click)="removePlanet(planet)">
              <mat-icon aria-label="Remove planet">delete_forever</mat-icon>
            </button>
          </div>
        </mat-list-item>
      </mat-list>
      <mat-card-actions>
        <button data-qa="cta-reset" mat-raised-button color="accent" (click)="reset()">Reset</button>
        <button data-qa="cta-start" mat-raised-button [color]="running() ? 'accent' : 'primary'" (click)="toggleSim()">
          {{ running() ? 'Pause' : 'Start' }}
        </button>
      </mat-card-actions>
    </mat-card-content>
  </mat-card>
  <mat-card appearance="raised" class="gravitational-force-card">
    <mat-toolbar color="primary">Enjoy, click and drag to manipulate.</mat-toolbar>
    <svg
      #svgWorld
      class="world-svg"
      (mousedown)="mouseDown($event)"
      (mousemove)="mouseMove($event)"
      (mouseup)="mouseUp($event)"
      [attr.viewBox]="'0 0 ' + canvasSize().x + ' ' + canvasSize().y"
    >
      <defs>
        <marker id="force-arrow-head" orient="auto" markerWidth="3" markerHeight="4" refX="0.1" refY="2">
          <path d="M0,0 V4 L2,2 Z" fill="#348B85" />
        </marker>
      </defs>
      <g>
        <circle
          class="world-object"
          *ngFor="let planet of planets()"
          [id]="planet.id"
          [attr.cx]="planet.pos.x"
          [attr.cy]="planet.pos.y"
          [attr.r]="planet.radius"
          [attr.fill]="planet.color"
        ></circle>
        <circle
          class="world-object sun"
          [id]="sun.id"
          [attr.cx]="sun.pos.x"
          [attr.cy]="sun.pos.y"
          [attr.r]="sun.radius"
          fill="#ffffab"
        ></circle>
        <path
          *ngFor="let dValue of forcesSvgPaths()"
          class="line-line"
          marker-end="url(#force-arrow-head)"
          stroke-width="6"
          fill="none"
          stroke="#348B85"
          [attr.d]="dValue"
        />
        <path
          *ngFor="let dValue of velocitySvgPath()"
          class="line-line"
          marker-end="url(#force-arrow-head)"
          stroke-width="6"
          fill="none"
          stroke="#8B5870"
          [attr.d]="dValue"
        />
      </g>
    </svg>
  </mat-card>
</div>
